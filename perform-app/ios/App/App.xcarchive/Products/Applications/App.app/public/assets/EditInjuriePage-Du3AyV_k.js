import{d as L,V as M,r as c,o as U,s as $,p as w,c as f,e as b,w as n,f as l,g as i,u as s,l as _,v as d,k as v,S as j,U as J,A as k,B as C,C as E,j as S,J as q,K as R,I as Z,h as F,G,i as H,D,t as N}from"./index-BSc-WbhD.js";import{a as A}from"./index-QnzCfbxr.js";import{_ as B}from"./NavButton-BzcajF2k.js";/* empty css              */import{g as K}from"./perform-body-component-lib-DGzadFkm.js";import{u as W}from"./useErrorHandler-eomL11xx.js";/* empty css                                                  */const Q={class:"perform-page"},X={style:{display:"flex","justify-content":"space-between"}},Y=i("h1",{style:{color:"black","margin-top":"5px","margin-bottom":"10px"}}," Modifier une blessure ",-1),ee={class:"input_injurie"},te={class:"input_injurie"},ae={class:"input_injurie"},se={class:"input_injurie"},le={class:"input_injurie"},ne={style:{display:"flex",width:"100%","margin-top":"16px","justify-content":"center","align-items":"center"}},me=L({__name:"EditInjuriePage",setup(oe){const{triggerError:h}=W(),P=M(),p=c(!1),u=c(!1),t=c({id:"",name:"",description:"",zone:[{zone:{name:"",code:""}}],date:"",user:"",state:""}),m=(o,a)=>{const e=a;switch(o){case"name":e.length>0?t.value.name=e[0].toUpperCase()+e.slice(1):t.name=e;break;case"description":t.value.description=e;break;case"zone":t.value.zone=[{zone:{code:e,name:""}}];break;case"date":t.value.date=e;break;case"state":t.value.state=e;break}},y=c({}),g=c(0),x=()=>{const o=document.querySelectorAll("ion-popover");if(o!==null)for(const a of o){const e=a.shadowRoot;if(e===null)return;const r=document.createElement("style");r.textContent=`
      .popover-content {
            margin-left: 9px;
            margin-top: 20px;
      }

    `,e.appendChild(r);const I=document.createElement("style");I.textContent=`
      .sc-ion-select-popover-md-h {
            left : 10px;
            width: calc(100vw - 40px);
      }

    `,a.appendChild(I)}},V=()=>{p.value=!0,G("/injuries/"+g.value+"/",{body:{name:t.value.name,description:t.value.description,zone:t.value.zone[0].zone.code,date:t.value.date,state:t.value.state,user:y.value.id}},!0).then(o=>{o.status>300?(h("Erreur lors de la modification de la blessure"),u.value=!0,p.value=!1):(H.push("/view_injuries/"+g.value+"/?edit=true"),u.value=!1)})},O=c([{code:"TR",name:"Soignée"},{code:"NT",name:"Pas soignée"},{code:"IP",name:"En cours"}]),z=c([]),T=o=>{t.value.zone=[{zone:{code:o,name:""}}]};return U(async()=>{g.value=Number(P.params.id),p.value=!1,t.value={id:"",name:"",description:"",zone:[{zone:{name:"",code:""}}],date:"",user:"",state:""},$.get("user").then(a=>{const e=a;e!==""&&(y.value=JSON.parse(e).user,w("/injuries/"+g.value+"/",{body:{}},!0).then(r=>{r.status>300?h("Erreur lors de la récupération des blessures"):(t.value=r,t.value.zone=[{zone:{code:r.zone.code,name:""}}])}))});const o=document.querySelectorAll(".custom-ion-select");if(o!==null){for(const a of o){const e=a.shadowRoot;if(e===null)return;const r=document.createElement("style");r.textContent=`
        .select-wrapper-inner {
        width: 100%; /* Ajustez cette valeur selon vos besoins */
        justify-content: space-between;
      }

    `,e.appendChild(r)}w("/workzones/all_injury",{body:{}},!1).then(a=>{a.status>301?h("Erreur lors de la récupération des muscles"):z.value=a})}}),(o,a)=>(f(),b(s(F),{"data-page":"edit-injuries"},{default:n(()=>[l(s(Z),null,{default:n(()=>[i("div",Q,[i("div",X,[l(B,{url:"profile",text:"Retour",back:"back"})]),Y,i("div",ee,[l(s(_),{class:d(u.value&&t.value.name==""?"required_text":"")},{default:n(()=>[v("Nom de la blessure *")]),_:1},8,["class"]),l(s(j),{class:d(u.value&&t.value.name==""?"required_class":""),"label-placement":"stacked",fill:"outline",value:t.value.name,onIonInput:a[0]||(a[0]=e=>m("name",e.detail.value)),placeholder:"Déchirure du quadriceps"},null,8,["class","value"])]),i("div",te,[l(s(_),null,{default:n(()=>[v("Description de la blessure")]),_:1}),l(s(J),{value:t.value.description,variant:"outlined",placeholder:"Décrivez votre blessure",onIonChange:a[1]||(a[1]=e=>m("description",e.detail.value))},null,8,["value"])]),i("div",ae,[l(s(_),{class:d(u.value&&t.value.zone.code==""?"required_text":"")},{default:n(()=>[v("Zone de la blessure")]),_:1},8,["class"]),l(s(k),{class:d([u.value&&t.value.zone.code==""?"required_class":"","filter-item"])},{default:n(()=>[l(s(C),null,{default:n(()=>[l(s(E),{interface:"popover",placeholder:"Zone de la blessure",class:"custom-ion-select","toggle-icon":s(A),justify:"space-between",value:t.value.zone[0].zone.code,onClick:a[2]||(a[2]=e=>x()),onIonChange:a[3]||(a[3]=e=>m("zone",e.detail.value))},{default:n(()=>[(f(!0),S(R,null,q(z.value,e=>(f(),b(s(D),{key:e.code,value:e.code},{default:n(()=>[v(N(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["toggle-icon","value"])]),_:1})]),_:1},8,["class"])]),i("div",se,[l(s(_),{class:d(u.value&&t.value.date==""?"required_text":"")},{default:n(()=>[v("Date de la blessure *")]),_:1},8,["class"]),l(s(j),{class:d(u.value&&t.value.date==""?"required_class":""),type:"date","label-placement":"stacked",fill:"outline",placeholder:"2021-09-01",value:t.value.date,onIonChange:a[4]||(a[4]=e=>m("date",e.detail.value))},null,8,["class","value"])]),i("div",le,[l(s(_),{class:d(u.value&&t.value.state==""?"required_text":"")},{default:n(()=>[v("Etat de la blessure *")]),_:1},8,["class"]),l(s(k),{class:d([u.value&&t.value.state==""?"required_class":"","filter-item"])},{default:n(()=>[l(s(C),null,{default:n(()=>[l(s(E),{value:t.value.state,interface:"popover",placeholder:"Etat de la blessure",class:"custom-ion-select","toggle-icon":s(A),justify:"space-between",onClick:a[5]||(a[5]=e=>x()),onIonChange:a[6]||(a[6]=e=>m("state",e.detail.value))},{default:n(()=>[(f(!0),S(R,null,q(O.value,e=>(f(),b(s(D),{key:e.code,value:e.code},{default:n(()=>[v(N(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","toggle-icon"])]),_:1})]),_:1},8,["class"])]),i("div",ne,[l(s(K),{setMuscleSelected:T,muscleSelected:t.value.zone,height:"200",width:"100",viewOnly:"edit",isInjury:!0},null,8,["muscleSelected"])]),l(B,{style:{width:"100%",height:"40px","margin-top":"20px"},onClick:V,disabled:p.value,text:p.value?"Enregistrement en cours..":"Enregistrer",noIcon:!0},null,8,["disabled","text"])])]),_:1})]),_:1}))}});export{me as default};
