import{_ as H}from"./NavButton-BzcajF2k.js";import{j as oe,b as ne}from"./index-QnzCfbxr.js";import{d as re,r as f,V as ue,P as O,a as ie,n as de,o as ce,s as pe,b as me,c as m,e as J,w as i,f as s,g as r,u as a,y as ve,I as W,x as fe,j as y,l as h,v as d,k as x,S as g,K as b,z as ye,t as M,E as R,J as xe,h as ge,p as _e,H as he,F as be,A as ke,Y as we,B as Ie,Z as Ve,$ as Se,N as Ce,O as $e,T as Ee}from"./index-BSc-WbhD.js";/* empty css              */import{C as Y,r as qe}from"./chart-BKG_MiTL.js";import{u as De}from"./useErrorHandler-eomL11xx.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                  */const D=S=>(Ce("data-v-74fe1676"),S=S(),$e(),S),Re={class:"perform-page",style:{display:"flex","flex-direction":"column"}},Ue={style:{display:"flex","justify-content":"space-between"}},Pe={style:{padding:"10px"}},Te={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"10px"}},Fe=D(()=>r("h1",{style:{margin:"0px"}},"Ajouter un nouveau record",-1)),Be={class:"time-input"},Me={class:"input_injurie"},Ne={style:{display:"flex","justify-content":"center",width:"100%"}},ze={style:{"text-align":"center",color:"black","margin-top":"35px","margin-bottom":"10px"}},Le={key:0},Ae=D(()=>r("h2",{style:{"text-align":"center"}},"Saisissez votre premier record !",-1)),He=[Ae],Oe={key:0,style:{margin:"20px",padding:"10px","border-radius":"10px",border:"solid 0.5px #eaeaea",position:"relative","z-index":"1","box-shadow":"silver 0px 10px 20px 0px"}},Je={key:0,id:"chartStats",width:"300px",height:"200px",min:"0",max:"10"},We={key:1,style:{margin:"20px",padding:"10px","border-radius":"10px",border:"solid 0.5px #eaeaea","z-index":"1000","box-shadow":"silver 0px 10px 20px 0px",flex:"1",overflow:"scroll",height:"calc(100vh - 520px)",display:"flex","flex-direction":"column"}},Ye=D(()=>r("h3",null,"Mes records passés",-1)),Ke=D(()=>r("div",{style:{display:"flex","justify-content":"space-between","border-bottom":"1px solid silver","padding-bottom":"10px","margin-bottom":"5px"}},[r("p",null,"Records"),r("p",null,"Date")],-1)),Ze={class:"scrollable-container",style:{flex:"1","overflow-y":"scroll"}},Ge=D(()=>r("div",{style:{display:"flex","justify-content":"space-between",width:"100%"},id:"recordListUser"},null,-1)),Qe={style:{"overflow-y":"auto",flex:"1"}},Xe=re({__name:"ShowRecords",props:{unit:{type:String,required:!0},label:{type:String,default:"Input"}},setup(S){const{triggerError:j}=De();Y.register(...qe);const K=S,o=f({record_name:"",performances:[],units:""}),U=f(["weight","distance_m","distance_km","points","reps"]),n=f(!1),v=f(""),k=f(""),w=f(""),I=f(""),N=f(""),p=f(""),C=f(""),_=f(""),$=f(null),z=ue(),V=(l,e)=>{console.log(e," ",l),e=="time"?_.value=new Date(l):U.value.includes(e)?(p.value=l,console.log(" weight ",p)):C.value=l};O(()=>K.unit,l=>{l==="kg"?(k.value="",w.value="",I.value=""):v.value=""});const Z=l=>{Ee("/records_user/"+l,!0).then(e=>{e.status&&e.status>300?j("Erreur à la suppression,"):P()})},G=l=>new Date(l).toLocaleDateString(),P=()=>{const l=z.params.record_id;_e("/records_user/by-record?record_id="+l,{body:{}},!0).then(e=>{if(e.status>300)j("Erreur lors de la récupération du record");else{o.value=e,console.log("record ",e);let t=!1,u=0;setTimeout(()=>{for(;t==!1&&u<3;){const q=document.querySelectorAll(".record-unit");if(q){t=!0,u=4;for(let B of q){const A=document.createElement("style");A.textContent=`
                .item-inner .input-wrapper {
                  padding-left : 10px !important;
                  padding-right : 10px !important;
                  width: 100%;
                  display : flex;
                  justify-content: space-between;
                }
                  .item-inner {
                  padding-left : 0px !important;
                  padding-right : 0px !important;
                }
              `,B.shadowRoot.appendChild(A)}}else u=u+1}},200),console.log(c.value),c.value&&c.value.destroy(),e.performances.length>0&&e.units!=="free"&&(c.value&&c.value.destroy(),setTimeout(()=>{T()},400))}})},c=f(null),Q=l=>{const e=new Date(l),t=String(e.getDate()).padStart(2,"0"),u=String(e.getMonth()+1).padStart(2,"0"),q=e.getFullYear();return`${t}/${u}/${q}`},X=l=>{const e=l.split(":");return parseInt(e[0])*3600+parseInt(e[1])*60+parseInt(e[2])},ee=l=>{const e=String(Math.floor(l/3600)).padStart(2,"0"),t=String(Math.floor(l%3600/60)).padStart(2,"0"),u=String(l%60).padStart(2,"0");return`${e}:${t}:${u}`},T=()=>{const l=o.value.performances.map(t=>Q(t.date_record)),e=o.value.performances.map(t=>o.value.units==="time"?X(t.time_value):t.record_value);c.value=he(new Y(document.getElementById("chartStats"),{type:"line",data:{labels:l,datasets:[{label:"Performance",data:e,borderColor:"#3767B8",backgroundColor:"#E8F8FEa6",fill:!0}]},options:{scales:{x:{title:{display:!0,text:"Date"}},y:{ticks:{callback:t=>{const u=o.value.units;return u==="time"?ee(t):u==="weight"?`${t.toFixed(2)} kg`:u==="distance_km"?`${t.toFixed(2)} km`:u==="distance_m"?`${t.toFixed(2)} m`:u==="points"||u==="reps"?`${t.toFixed(0)}`:u==="free"?t:t.toFixed(2)}},title:{display:!0,text:"Performance"}}},plugins:{legend:{display:!0,labels:{font:{size:12},boxWidth:30,boxHeight:1}}}}}))},L=()=>{n.value=!1,k.value="",w.value="",I.value="",_.value=null,p.value="",_.value=""};ie(()=>{_.value=null,c.value&&(c.value.destroy(),setTimeout(()=>{document.getElementById("chartStats")&&T()},100))}),O(o.value.performances,()=>{c.value&&c.value.destroy(),T()},{deep:!0});const E=()=>k.value!==""||w.value!=""||I.value!="",te=async()=>{o.value.units==="time"&&E()||U.value.includes(o.value.units)&&p.value!=""||C.value!=""?F():(n.value=!0,j("Erreur à l'ajout, remplissez les champs"))},F=()=>{const l=o.value.units==="time"?se(le.value):null,e={record:Number(z.params.record_id),user:N.value.id,date_record:_.value,time_value:o.value.units==="time"&&(k.value!==""||w.value!=""||I.value!="")?l:null,record_value:U.value.includes(o.value.units)?p.value:null,free_value:o.value.units==="free"?C.value:null};try{be("/records_user/",{body:e},!0).then(t=>{t.status&&t.status>300?j("Erreur à l'ajout du record"):($.value.$el.dismiss(),c.value&&c.value.destroy(),L(),P())})}catch(t){console.error("Error:",t)}},le=de(()=>`${k.value}:${w.value}:${I.value}`),ae=async l=>{l.$el.present()},se=l=>{const[e,t,u]=l.split(":").map(B=>B.padStart(2,"0"));return`00 ${e}:${t}:${u}`};return ce(async()=>{L();const l=await pe.get("user");N.value=JSON.parse(l).user,c.value&&c.value.destroy(),P()}),me(()=>{c.value&&c.value.destroy()}),(l,e)=>(m(),J(a(ge),{"data-page":"ShowRecords"},{default:i(()=>[s(a(W),{id:"list-records"},{default:i(()=>[r("div",Re,[r("div",Ue,[s(H,{url:"records",text:"Retour",back:"back"}),s(H,{url:"",text:"Ajouter un record",onClick:e[0]||(e[0]=t=>ae($.value)),icon:a(oe)},null,8,["icon"]),s(a(ve),{class:"static-modal",ref_key:"modalRecord",ref:$},{default:i(()=>[s(a(W),null,{default:i(()=>[r("div",Pe,[r("div",Te,[Fe,s(a(fe),{class:"close-icon",onClick:e[1]||(e[1]=t=>$.value?$.value.$el.dismiss():""),icon:a(ne)},null,8,["icon"])]),r("div",null,[o.value.units==="weight"?(m(),y(b,{key:0},[s(a(h),{position:"stacked",class:d(n.value&&p.value==""?"required_text":"")},{default:i(()=>[x("Poids (en kg)")]),_:1},8,["class"]),s(a(g),{class:d(n.value&&p.value==""?"required_class":""),modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=t=>v.value=t),type:"number",placeholder:"Entez le poids en kg",style:{"padding-left":"10px"},onIonChange:e[3]||(e[3]=t=>V(t.detail.value,"weight"))},null,8,["class","modelValue"])],64)):o.value.units==="time"?(m(),y(b,{key:1},[s(a(h),{position:"stacked",class:d(n.value&&!E()?"required_text":"")},{default:i(()=>[x("Temps (en hh:mm:ss)")]),_:1},8,["class"]),r("div",Be,[s(a(g),{modelValue:k.value,"onUpdate:modelValue":e[4]||(e[4]=t=>k.value=t),"aria-label":"hours",type:"number",labelPlacement:void 0,placeholder:"HH",maxLength:"2",class:d(["time_input",n.value&&!E()?"required_class":""]),style:{"padding-inline-start":"0px","--padding-end":"0px"}},null,8,["modelValue","class"]),x(": "),s(a(g),{modelValue:w.value,"onUpdate:modelValue":e[5]||(e[5]=t=>w.value=t),type:"number",placeholder:"MM","aria-label":"minutes",labelPlacement:void 0,maxLength:"2",class:d(["time_input",n.value&&!E()?"required_class":""])},null,8,["modelValue","class"]),x(": "),s(a(g),{modelValue:I.value,"onUpdate:modelValue":e[6]||(e[6]=t=>I.value=t),type:"number",placeholder:"SS","aria-label":"secondes",labelPlacement:void 0,maxLength:"2",class:d(["time_input",n.value&&!E()?"required_class":""])},null,8,["modelValue","class"])])],64)):o.value.units==="points"?(m(),y(b,{key:2},[s(a(h),{position:"stacked",class:d(n.value&&p.value==""?"required_text":"")},{default:i(()=>[x("Points")]),_:1},8,["class"]),s(a(g),{class:d(n.value&&p.value==""?"required_class":""),modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=t=>v.value=t),type:"number",placeholder:"Entrer les points",style:{"padding-left":"10px"},onIonChange:e[8]||(e[8]=t=>V(t.detail.value,"points"))},null,8,["class","modelValue"])],64)):o.value.units==="distance_m"?(m(),y(b,{key:3},[s(a(h),{position:"stacked",class:d(n.value&&p.value==""?"required_text":"")},{default:i(()=>[x("Distance (en m)")]),_:1},8,["class"]),s(a(g),{class:d(n.value&&p.value==""?"required_class":""),modelValue:v.value,"onUpdate:modelValue":e[9]||(e[9]=t=>v.value=t),type:"number",placeholder:"Entrer la distance (en m)",style:{"padding-left":"10px"},onIonChange:e[10]||(e[10]=t=>V(t.detail.value,"distance_m"))},null,8,["class","modelValue"])],64)):o.value.units==="distance_km"?(m(),y(b,{key:4},[s(a(h),{position:"stacked",class:d(n.value&&p.value==""?"required_text":"")},{default:i(()=>[x("Distance (en km)")]),_:1},8,["class"]),s(a(g),{class:d(n.value&&p.value==""?"required_class":""),modelValue:v.value,"onUpdate:modelValue":e[11]||(e[11]=t=>v.value=t),type:"number",placeholder:"Entrer la distance (en km)",style:{"padding-left":"10px"},onIonChange:e[12]||(e[12]=t=>V(t.detail.value,"distance_km"))},null,8,["class","modelValue"])],64)):o.value.units==="reps"?(m(),y(b,{key:5},[s(a(h),{position:"stacked",class:d(n.value&&p.value==""?"required_text":"")},{default:i(()=>[x("Nombre de répétitions")]),_:1},8,["class"]),s(a(g),{class:d(n.value&&p.value==""?"required_class":""),modelValue:v.value,"onUpdate:modelValue":e[13]||(e[13]=t=>v.value=t),type:"number",placeholder:"Entrer le nombres de répétitions maxs",style:{"padding-left":"10px"},onIonChange:e[14]||(e[14]=t=>V(t.detail.value,"reps"))},null,8,["class","modelValue"])],64)):(m(),y(b,{key:6},[s(a(h),{position:"stacked",class:d(n.value&&C.value==""?"required_text":"")},{default:i(()=>[x("Personnalisé")]),_:1},8,["class"]),s(a(g),{class:d(n.value&&C.value==""?"required_class":""),modelValue:v.value,"onUpdate:modelValue":e[15]||(e[15]=t=>v.value=t),type:"text",placeholder:"Entrer un record personnalisé",style:{"padding-left":"10px"},onIonChange:e[16]||(e[16]=t=>V(t.detail.value,"free"))},null,8,["class","modelValue"])],64)),r("div",Me,[s(a(h),{class:d(n.value&&(_.value==""||_.value==null)?"required_text":"")},{default:i(()=>[x("Date du record *")]),_:1},8,["class"]),s(a(g),{class:d(n.value&&(_.value==""||_.value==null)?"required_class":""),type:"date","label-placement":"stacked",fill:"outline",placeholder:"2021-09-01",onIonChange:e[17]||(e[17]=t=>V(t.detail.value,"time"))},null,8,["class"])]),r("div",Ne,[s(a(ye),{onClick:te},{default:i(()=>[x(" Ajouter ")]),_:1})])])])]),_:1})]),_:1},512)]),r("h1",ze,M(o.value.record_name),1),o.value.performances.length<=0?(m(),y("div",Le,He)):R("",!0)]),o.value.performances.length>0?(m(),y("div",Oe,[o.value.units!=="free"?(m(),y("canvas",Je)):R("",!0)])):R("",!0),o.value.performances.length>0?(m(),y("div",We,[Ye,Ke,r("div",Ze,[Ge,r("div",Qe,[(m(!0),y(b,null,xe(o.value.performances.slice().reverse(),t=>(m(),J(a(ke),{style:{height:"auto"},key:t.id,class:"records-list"},{default:i(()=>[s(a(we),null,{default:i(()=>[s(a(Ie),{class:"record-unit",style:{display:"flex","justify-content":"space-between",width:"100%"}},{default:i(()=>[r("p",null,M(t.formatted_record),1),r("p",null,M(G(t.date_record)),1)]),_:2},1024),s(a(Ve),{side:"end"},{default:i(()=>[s(a(Se),{color:"danger",expandable:"",onClick:u=>Z(t.id)},{default:i(()=>[x(" Supprimer ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))])])])):R("",!0)]),_:1})]),_:1}))}}),ut=je(Xe,[["__scopeId","data-v-74fe1676"]]);export{ut as default};
